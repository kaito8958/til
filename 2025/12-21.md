## TIL（2025-12-21）

### 記述式試験の回答保存時に発生するDBエラーへの対応

記述式試験の回答送信時に、特定の文字を含む入力が行われると  
データベース保存時にエラーが発生する事象について、  
原因調査から実装までを行った。

調査の結果、回答本文にデータベースで扱えない文字が含まれている場合、  
保存処理（INSERT）時に例外が発生し、  
アプリケーション側ではシステムエラーとして返ってしまうことを理解した。

対応として、保存処理の直前で入力内容を検証するのではなく、  
回答モデルにバリデーションを追加し、  
保存前の段階で不正な入力を検知・中断する実装を行った。

これにより、データベース例外が発生する前に処理を終了でき、  
既存の処理フローやDB設定に影響を与えずに  
安全にエラーを防止できることを確認した。

また、ローカル環境で画面上の完全な再現が困難なケースでも、  
Rails console を用いてモデル単体の validation を確認することで、  
実装の正当性を検証できることを学んだ。
