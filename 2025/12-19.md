## TIL（2025-12-19）

### 記述式試験における入力エラーの原因調査

記述式試験の回答送信時に、特定の文字（絵文字）を含む入力を行うと  
システムエラーが発生する事象について調査を行った。

ログ情報をもとに確認したところ、  
回答データを保存する処理の中で  
データベースへの保存（INSERT）時にエラーが発生していることが分かった。

原因として、入力文字列にデータベース側で扱えない文字が含まれており、  
文字コードの制約により保存処理が失敗しているケースがあることを理解した。

このような場合、Rails アプリケーション側で事前に入力内容を検証せずに  
そのまま保存処理へ進むと、  
DB レイヤーで例外が発生し、ユーザーにはシステムエラーとして返ってしまう。

そのため、DB や文字コード設定を変更するのではなく、  
保存前に入力内容を検証し、  
不正な文字が含まれている場合は  
バリデーションエラーとして扱い再入力を促す実装が  
安全かつ運用面でも有効であると学んだ。
